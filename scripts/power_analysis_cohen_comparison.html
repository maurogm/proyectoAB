<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
  padding-top: 0px;
}
</style>

</head>

<body>

<h1 id="comparacion-power-analysis">Comparación power analysis</h1>
<p>2020-04-17</p>
<p>Carga de dependencias:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(<span class="st">&quot;data.table&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(<span class="st">'tidyverse'</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(<span class="st">&quot;pwr&quot;</span>)</a></code></pre></div>
<p>Función para cálculo manual de la potencia de un test de diferencia de proporciones entre muestras de distinto tamaño:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">power_calculation_manual &lt;-<span class="st"> </span><span class="cf">function</span>(thetaA, effect_size, nA, nB, <span class="dt">alpha =</span> <span class="fl">0.05</span>, <span class="dt">tail =</span> <span class="kw">c</span>(<span class="st">'two.tailed'</span>, <span class="st">'right'</span>, <span class="st">'left'</span>)) {</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  thetaB_null &lt;-<span class="st"> </span>thetaA</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">  thetaB_alt &lt;-<span class="st"> </span>thetaA <span class="op">+</span><span class="st"> </span>effect_size</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  sigmaA &lt;-<span class="st"> </span><span class="kw">sqrt</span>(thetaA <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>thetaA) <span class="op">/</span><span class="st"> </span>nA)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  sigmaB_null &lt;-<span class="st"> </span><span class="kw">sqrt</span>(thetaB_null <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>thetaB_null) <span class="op">/</span><span class="st"> </span>nB)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">  sigmaB_alt  &lt;-<span class="st"> </span><span class="kw">sqrt</span>(thetaB_alt <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>thetaB_alt) <span class="op">/</span><span class="st"> </span>nB)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb2-9" data-line-number="9">  muDiff_null &lt;-<span class="st"> </span>thetaA <span class="op">-</span><span class="st"> </span>thetaB_null</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">  sigmaDiff_null &lt;-<span class="st"> </span><span class="kw">sqrt</span>(sigmaA<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>sigmaB_null<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">  crit_value &lt;-<span class="st"> </span><span class="kw">case_when</span>(tail <span class="op">==</span><span class="st"> 'right'</span> <span class="op">~</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha, muDiff_null, sigmaDiff_null),</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">                          tail <span class="op">==</span><span class="st"> 'left'</span> <span class="op">~</span><span class="st"> </span><span class="kw">qnorm</span>(alpha, muDiff_null, sigmaDiff_null),</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">                          tail <span class="op">==</span><span class="st"> 'two.tailed'</span> <span class="op">~</span><span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha <span class="op">/</span><span class="st"> </span><span class="dv">2</span>, muDiff_null, sigmaDiff_null))</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">  </a>
<a class="sourceLine" id="cb2-15" data-line-number="15">  muDiff_alt &lt;-<span class="st"> </span>thetaA <span class="op">-</span><span class="st"> </span>thetaB_alt</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">  sigmaDiff_alt &lt;-<span class="st"> </span><span class="kw">sqrt</span>(sigmaA<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>sigmaB_alt<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb2-18" data-line-number="18">  beta &lt;-<span class="st"> </span><span class="kw">pnorm</span>(crit_value, muDiff_alt, sigmaDiff_alt)</a>
<a class="sourceLine" id="cb2-19" data-line-number="19">  beta &lt;-<span class="st"> </span><span class="kw">case_when</span>(tail <span class="op">==</span><span class="st"> 'right'</span> <span class="op">~</span><span class="st"> </span><span class="kw">pnorm</span>(crit_value, muDiff_alt, sigmaDiff_alt),</a>
<a class="sourceLine" id="cb2-20" data-line-number="20">                    tail <span class="op">==</span><span class="st"> 'left'</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(crit_value, muDiff_alt, sigmaDiff_alt),</a>
<a class="sourceLine" id="cb2-21" data-line-number="21">                    tail <span class="op">==</span><span class="st"> 'two.tailed'</span> <span class="op">~</span><span class="st"> </span><span class="kw">pnorm</span>(crit_value, muDiff_alt, sigmaDiff_alt) <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="op">-</span>crit_value, muDiff_alt, sigmaDiff_alt) )</a>
<a class="sourceLine" id="cb2-22" data-line-number="22">  power &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>beta</a>
<a class="sourceLine" id="cb2-23" data-line-number="23">  <span class="kw">list</span>(<span class="dt">thetaA =</span> thetaA, <span class="dt">effect_size =</span> effect_size, <span class="dt">nA =</span> nA, <span class="dt">nB =</span> nB, <span class="dt">alpha =</span> alpha, <span class="dt">tail =</span> tail, <span class="dt">beta =</span> beta, <span class="dt">power =</span> power)</a>
<a class="sourceLine" id="cb2-24" data-line-number="24">}</a></code></pre></div>
<p>Datos de ejemplo, tomados del <a href="https://researchdespegar.wordpress.com/2015/06/19/what-is-hypothesis-te">blog post de Despegar Research sobre AB testing</a></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">tail &lt;-<span class="st"> 'left'</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">nA &lt;-<span class="st"> </span><span class="dv">2000000</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">nB &lt;-<span class="st"> </span><span class="dv">1000000</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">thetaA &lt;-<span class="st"> </span><span class="fl">0.02</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">effect_size &lt;-<span class="st"> </span>thetaA <span class="op">*</span><span class="st"> </span><span class="fl">1.01</span> <span class="op">-</span><span class="st"> </span>thetaA</a></code></pre></div>
<p>Output del cálculo manual:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">power_calculation_manual</span>(thetaA, effect_size, nA, nB, alpha, tail)</a></code></pre></div>
<pre><code>## $thetaA
## [1] 0.02
## 
## $effect_size
## [1] 2e-04
## 
## $nA
## [1] 2e+06
## 
## $nB
## [1] 1e+06
## 
## $alpha
## [1] 0.05
## 
## $tail
## [1] &quot;left&quot;
## 
## $beta
## [1] 0.6832747
## 
## $power
## [1] 0.3167253
</code></pre>
<p>Es consistente con el post previamente mencionado.</p>
<p>El output de usar el <a href="https://cran.r-project.org/web/packages/pwr/index.html">paquete de R pwr</a> arroja el mismo resultado:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">pwr.2p2n.test</span>(<span class="dt">h =</span> <span class="kw">ES.h</span>(thetaA, thetaA <span class="op">+</span><span class="st"> </span>effect_size), <span class="dt">n1 =</span> nA, <span class="dt">n2 =</span> nB, <span class="dt">sig.level =</span> alpha, <span class="dt">alternative =</span> <span class="st">'less'</span>)</a></code></pre></div>
<pre><code>## 
##      difference of proportion power calculation for binomial distribution (arcsine transformation) 
## 
##               h = -0.00142509
##              n1 = 2e+06
##              n2 = 1e+06
##       sig.level = 0.05
##           power = 0.3151615
##     alternative = less
## 
## NOTE: different sample sizes
</code></pre>
<p>Ahora bien, para correrlo correctamente se debió usar la función ES.h para calcular el effect size apropiado, tal como indican el manual del paquete y <a href="https://cran.r-project.org/web/packages/pwr/vignettes/pwr-vignette.html">la viñeta del mismo</a>. Si se pasa el effect size sin ser transformado, el resultado es otro:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">pwr.2p2n.test</span>(<span class="dt">h =</span> effect_size, <span class="dt">n1 =</span> nA, <span class="dt">n2 =</span> nB, <span class="dt">sig.level =</span> alpha, <span class="dt">alternative =</span> <span class="st">'less'</span>)</a></code></pre></div>
<pre><code>## 
##      difference of proportion power calculation for binomial distribution (arcsine transformation) 
## 
##               h = 2e-04
##              n1 = 2e+06
##              n2 = 1e+06
##       sig.level = 0.05
##           power = 0.03529135
##     alternative = less
## 
## NOTE: different sample sizes
</code></pre>
<p>Pareciera entonces que la transformación que es necesario realizar para pasar al parámetro h tiene que ver con la implementación específica elegida por este paquete, más que con un procedimiento necesario en general. Este paquete es la implementación del libro <a href="https://drive.google.com/open?id=1_fZ6zUU9Zv9-gnBZVlz2Uw80aQNCghK1">Cohen - Statistical Power Analysis for the Behavioral Sciences</a>. Allí dice (sección 6.2, p.180):</p>
<p>If we were to define j = P 1 - P 2 , and try to use j as our ES, we would soon discover that the delectability of some given value of j, under given fixed conditions of a and n, would not be constant, but would vary depending upon where along the scale of P between zero and one the value j occurred.</p>
<p>Luego procede a sugerir usar como h la diferencia entre las probabilidades transformadas por 2*arcsin(sqrt(p)). No obstante, en la implementación power_calculation_manual no se hizo nada por el estilo, y sin embargo llegamos al mismo resultado.</p>
<p>En efecto, en ese mismo capítulo un poco más arriba menciona:</p>
<p>It is possible to approach the testing of hypotheses about proportions by different statistical techniques, including <strong>the classical normal curve test using a “critical ratio” applied directly to the proportions</strong> (Edwards, 1972, pp. 42-44; Guilford&amp;Fruchter, 1978, pp. 159-161; Blalock, 1972, pp. 228-232), by a chi-square contingency test (see Chapter 7 and references), by a special case of the hypergeometric probability distribution (&quot;Fisher’s Exact Method’’) for 2 x 2 tables (Hays, 1981, pp. 552-554; Owen, 1962, pp. 479-496), <strong>or by means of a normal curve test applied to the arcsine transformation of the proportions. Despite its unfamiliarity, it is the last of these alternatives that provides the basis for the approach of this chapter because of certain advantages it has, particularly from the viewpoint of power analysis</strong>. However, the results from using any of these procedures will be the same to a close approximation, particularly when samples are not small (Cohen, 1970).</p>
<p>Lo bueno es que refuerza y reconoce que su método es análogo al clásico. Lo malo es que por ahora no me quedan claros los pormenores de su método, ni cuáles son esas <em>ciertas ventajas</em> que menciona.</p>
<p>En la introducción (sección 1.4) habla de la necesidad de normalizar escalas para desprenderse de unidades, en particular teniendo en cuenta que después presenta tablas de referencia para consultar potencias y tamaños de muestra. Así que puede ser que una normalización permita una ventaja en ese sentido. Pero la verdad que por ahora no me queda claro; y tampoco sé si vale la pena en esta instancia.</p>

</body>
</html>
